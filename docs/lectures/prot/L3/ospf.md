import PDU from '../../../../static/lib/pdu'
import Mermaid from '../../../../static/lib/Mermaid'
import IframeComponent from '../../../../static/lib/iframe'

# OSPF
**OSPF** (*Open Shortest Path First*) — это динамический протокол для обмена информацией о маршрутах между маршрутизаторами в одной автономной системе (AS). 

## Основные характеристики OSPF

1. Тип протокола:
   - Протокол маршрутизации с состоянием канала (link-state).
   - Использует алгоритм Дейкстры (Дейкстра используется потому что это наиболее быстрый алгоритм, который может рассчитать всю сеть, а не point-to-point как, например A*) для построения кратчайшего пути.

2. Метрика:
   - Основана на стоимости (cost), которая обычно рассчитывается на основе пропускной способности (bandwidth) интерфейса.

3. Административное расстояние:
   - 110

## Основные функции и возможности OSPF

1. **Области (Areas):**
   - Для уменьшения объема трафика маршрутизации и повышения эффективности, OSPF делит сеть на области.
   - Backbone Area (Area 0): центральная область, к которой подключены все остальные области.
   - Non-backbone Areas: вспомогательные области, такие как Stub, Totally Stubby, Not-So-Stubby Area (NSSA).

2. **Соседства (Adjacencies):**
   - OSPF создает соседские отношения (adjacencies) между маршрутизаторами через процесс Hello.
   - Hello-пакеты определяют соседей и проверяют их работоспособность.

3. **Типы маршрутизаторов в OSPF:**
   - **Internal Router (IR):** Все интерфейсы принадлежат одной области.
   - **Backbone Router (BR):** Интерфейсы находятся в Area 0.
   - **Area Border Router (ABR):** Соединяет Area 0 с другими областями.
   - **Autonomous System Boundary Router (ASBR):** Соединяет автономную систему OSPF с внешними сетями.

4. **Типы пакетов OSPF:**
   - **Hello:** Установление и поддержание соседских отношений.
   - **Database Description (DBD):** Обмен информацией о состоянии канала.
   - **Link-State Request (LSR):** Запрос обновлений состояния канала.
   - **Link-State Update (LSU):** Распространение обновлений.
   - **Link-State Acknowledgment (LSAck):** Подтверждение получения обновлений.

5. **Типы сетей:**
   - Point-to-Point.
   - Broadcast (например, Ethernet).
   - Non-Broadcast Multi-Access (NBMA, например, Frame Relay).
   - Point-to-Multipoint.

6. **Алгоритм работы OSPF:**
   - Каждый маршрутизатор создает таблицу состояния канала (Link-State Database, LSDB).
   - Сначала маршрутизатор отправляет Hello-пакеты для обнаружения соседей.
   - После установления соседства маршрутизаторы обмениваются LSAs (Link-State Advertisements).
   - Маршрутизатор строит топологическую карту сети на основе LSDB.
   - Алгоритм SPF рассчитывает кратчайший путь к каждой сети.

7. **Типы LSA (Link-State Advertisement):**
   - **Type 1 (Router LSA):** Информация о маршрутизаторе и его связях.
   - **Type 2 (Network LSA):** Информация о многоточечной сети.
   - **Type 3 (Summary LSA):** Агрегированные маршруты между областями.
   - **Type 4 (ASBR Summary LSA):** Информация о пути к ASBR.
   - **Type 5 (External LSA):** Информация о внешних маршрутах (например, из EIGRP, BGP).
   - **Type 7 (NSSA LSA):** Внешние маршруты в NSSA-области.

## Пакет OSPF

<PDU maxCellSize={32} name={'Пакет OSPF'} data={[
    { 
        size: 8, 
        name: "Версия",
        desc: `Версия OSPF: OSPFv2 для IPv4, OSPFv3 для IPv6.`
    },
    { 
        size: 8, 
        name: "Тип сообщения",
        desc: `Hello, Database Description (DBD), Link-State Request (LSR), Link-State Update (LSU), Link-State Acknowledgment (LSAck)`
    },
    { 
        size: 16, 
        name: "Длина сообщения"
    },
    { 
        size: 32, 
        name: "ID маршрута",
        desc: `Записывается как IPv4, но не является никаким ip адресом. Чем ниже ID тем маршрут главнее. Его можно назначать руками или автоматически (главный с наименьшим IP, если нет, то с физическим интерфейсом)`
    },
    { 
        size: 32, 
        name: "ID области",
        desc: `Предел области`
    },
    { 
        size: 16, 
        name: "Контрольная сумма"
    },
    { 
        size: 16, 
        name: "Тип идентификации",
        desc: `Нет идентификации, идентификация открытым текстом, шифрованный MD5(алгоритм шифрования)`
    },
    { 
        size: 32, 
        name: "Идентификация"
    },
    { 
        size: 32, 
        name: "Идентификация"
    },
]} />
